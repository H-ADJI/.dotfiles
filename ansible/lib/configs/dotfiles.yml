- name: Stowing dotfiles
  hosts: localhost
  become: true
  become_user: "{{ user }}"
  vars:
    git_repo_url: https://github.com/H-ADJI/.dotfiles
    git_repo_dir: "{{ home_dir }}/.dotfiles"
  tasks:
    - name: Clone the dotfiles repository
      ansible.builtin.git:
        repo: "{{ git_repo_url }}"
        dest: "{{ git_repo_dir }}"
        clone: yes

    - name: Define the list of folders to stow
      set_fact:
        folders:
          - nvim
          - zsh
          - git
          - tmux

    - name: Apply stow to each folder
      ansible.builtin.command:
        cmd: stow -v -t ~ "{{ item }}"
        chdir: "{{ home_dir }}/.dotfiles"
      loop: "{{ folders }}"
